graph:
    nodes:
        DATABASE:payments-db:
            id: DATABASE:payments-db
            name: payments-db
            kind: DATABASE
            attrs:
                owner: payment-service
        DATABASE:users-db:
            id: DATABASE:users-db
            name: users-db
            kind: DATABASE
            attrs:
                owner: auth-service
        SERVICE:api-gateway:
            id: SERVICE:api-gateway
            name: api-gateway
            kind: SERVICE
            attrs: {}
        SERVICE:auth-service:
            id: SERVICE:auth-service
            name: auth-service
            kind: SERVICE
            attrs: {}
        SERVICE:billing-service:
            id: SERVICE:billing-service
            name: billing-service
            kind: SERVICE
            attrs: {}
        SERVICE:payment-service:
            id: SERVICE:payment-service
            name: payment-service
            kind: SERVICE
            attrs: {}
        SERVICE:user-service:
            id: SERVICE:user-service
            name: user-service
            kind: SERVICE
            attrs: {}
    edges:
        - from: SERVICE:api-gateway
          to: SERVICE:user-service
          kind: CALLS
          attrs:
            count: 1
            endpoints:
                - GET /users/:id
            per_item: false
            rate_per_min: 600
        - from: SERVICE:api-gateway
          to: SERVICE:billing-service
          kind: CALLS
          attrs:
            count: 1
            endpoints:
                - POST /bill
            per_item: false
            rate_per_min: 300
        - from: SERVICE:user-service
          to: SERVICE:auth-service
          kind: CALLS
          attrs:
            count: 1
            endpoints:
                - POST /verify
            per_item: false
            rate_per_min: 600
        - from: SERVICE:user-service
          to: DATABASE:users-db
          kind: READS
          attrs: {}
        - from: SERVICE:auth-service
          to: DATABASE:users-db
          kind: READS
          attrs: {}
        - from: SERVICE:auth-service
          to: DATABASE:users-db
          kind: WRITES
          attrs:
            owner: true
        - from: SERVICE:billing-service
          to: SERVICE:payment-service
          kind: CALLS
          attrs:
            count: 1
            endpoints:
                - POST /charge
            per_item: false
            rate_per_min: 500
        - from: SERVICE:billing-service
          to: DATABASE:payments-db
          kind: READS
          attrs: {}
        - from: SERVICE:payment-service
          to: DATABASE:payments-db
          kind: WRITES
          attrs:
            owner: true
    out:
        SERVICE:api-gateway:
            - from: SERVICE:api-gateway
              to: SERVICE:user-service
              kind: CALLS
              attrs:
                count: 1
                endpoints:
                    - GET /users/:id
                per_item: false
                rate_per_min: 600
            - from: SERVICE:api-gateway
              to: SERVICE:billing-service
              kind: CALLS
              attrs:
                count: 1
                endpoints:
                    - POST /bill
                per_item: false
                rate_per_min: 300
        SERVICE:auth-service:
            - from: SERVICE:auth-service
              to: DATABASE:users-db
              kind: READS
              attrs: {}
            - from: SERVICE:auth-service
              to: DATABASE:users-db
              kind: WRITES
              attrs:
                owner: true
        SERVICE:billing-service:
            - from: SERVICE:billing-service
              to: SERVICE:payment-service
              kind: CALLS
              attrs:
                count: 1
                endpoints:
                    - POST /charge
                per_item: false
                rate_per_min: 500
            - from: SERVICE:billing-service
              to: DATABASE:payments-db
              kind: READS
              attrs: {}
        SERVICE:payment-service:
            - from: SERVICE:payment-service
              to: DATABASE:payments-db
              kind: WRITES
              attrs:
                owner: true
        SERVICE:user-service:
            - from: SERVICE:user-service
              to: SERVICE:auth-service
              kind: CALLS
              attrs:
                count: 1
                endpoints:
                    - POST /verify
                per_item: false
                rate_per_min: 600
            - from: SERVICE:user-service
              to: DATABASE:users-db
              kind: READS
              attrs: {}
    in:
        DATABASE:payments-db:
            - from: SERVICE:billing-service
              to: DATABASE:payments-db
              kind: READS
              attrs: {}
            - from: SERVICE:payment-service
              to: DATABASE:payments-db
              kind: WRITES
              attrs:
                owner: true
        DATABASE:users-db:
            - from: SERVICE:user-service
              to: DATABASE:users-db
              kind: READS
              attrs: {}
            - from: SERVICE:auth-service
              to: DATABASE:users-db
              kind: READS
              attrs: {}
            - from: SERVICE:auth-service
              to: DATABASE:users-db
              kind: WRITES
              attrs:
                owner: true
        SERVICE:auth-service:
            - from: SERVICE:user-service
              to: SERVICE:auth-service
              kind: CALLS
              attrs:
                count: 1
                endpoints:
                    - POST /verify
                per_item: false
                rate_per_min: 600
        SERVICE:billing-service:
            - from: SERVICE:api-gateway
              to: SERVICE:billing-service
              kind: CALLS
              attrs:
                count: 1
                endpoints:
                    - POST /bill
                per_item: false
                rate_per_min: 300
        SERVICE:payment-service:
            - from: SERVICE:billing-service
              to: SERVICE:payment-service
              kind: CALLS
              attrs:
                count: 1
                endpoints:
                    - POST /charge
                per_item: false
                rate_per_min: 500
        SERVICE:user-service:
            - from: SERVICE:api-gateway
              to: SERVICE:user-service
              kind: CALLS
              attrs:
                count: 1
                endpoints:
                    - GET /users/:id
                per_item: false
                rate_per_min: 600
dot_path: /app/out/runs/92c2011dbaa488aa/graph.dot
svg_path: /app/out/runs/92c2011dbaa488aa/graph.svg
detections:
    - kind: chatty_calls
      severity: MEDIUM
      title: Chatty call
      summary: High-frequency or per-item chattiness between services
      nodes:
        - SERVICE:api-gateway
        - SERVICE:user-service
      edges:
        - 0
      evidence:
        per_item: false
        rate_per_min: 600
    - kind: chatty_calls
      severity: MEDIUM
      title: Chatty call
      summary: High-frequency or per-item chattiness between services
      nodes:
        - SERVICE:api-gateway
        - SERVICE:billing-service
      edges:
        - 1
      evidence:
        per_item: false
        rate_per_min: 300
    - kind: chatty_calls
      severity: MEDIUM
      title: Chatty call
      summary: High-frequency or per-item chattiness between services
      nodes:
        - SERVICE:user-service
        - SERVICE:auth-service
      edges:
        - 2
      evidence:
        per_item: false
        rate_per_min: 600
    - kind: chatty_calls
      severity: MEDIUM
      title: Chatty call
      summary: High-frequency or per-item chattiness between services
      nodes:
        - SERVICE:billing-service
        - SERVICE:payment-service
      edges:
        - 6
      evidence:
        per_item: false
        rate_per_min: 500
    - kind: cross_db_read
      severity: MEDIUM
      title: Cross-DB read
      summary: Service reads DB owned by another service
      nodes:
        - SERVICE:user-service
        - DATABASE:users-db
      edges:
        - 3
      evidence:
        owner: auth-service
        reader: user-service
    - kind: cross_db_read
      severity: MEDIUM
      title: Cross-DB read
      summary: Service reads DB owned by another service
      nodes:
        - SERVICE:billing-service
        - DATABASE:payments-db
      edges:
        - 7
      evidence:
        owner: payment-service
        reader: billing-service

services:
  - name: api-gateway
    calls:
      - to: order-service
        endpoints: ["POST /orders"]
        rate_per_min: 300

  - name: order-service
    calls:
      - to: inventory-service
        endpoints: ["GET /inventory/:sku"]
        rate_per_min: 950

      - to: user-service
        endpoints: ["GET /users/:id"]
        rate_per_min: 260
      - to: billing-service
        endpoints: ["POST /bill"]
        rate_per_min: 360
      - to: notification-service
        endpoints: ["POST /notify"]
        rate_per_min: 220
      - to: search-service
        endpoints: ["GET /search/recommendations"]
        rate_per_min: 180

    databases:
      reads: [orders-db, users-db]
      writes: [orders-db]

  - name: inventory-service
    calls:
      - to: order-service
        endpoints: ["POST /inventory/reserve"]
        rate_per_min: 820

      - to: billing-service
        endpoints: ["POST /bill/inventory-fee"]
        rate_per_min: 320

    databases:
      reads: [orders-db]
      writes: [orders-db]

  - name: billing-service
    calls:
      - to: order-service
        endpoints: ["POST /orders/confirm"]
        rate_per_min: 260
    databases:
      reads: [payments-db]
      writes: [payments-db]

  - name: user-service
    databases:
      reads: [users-db]
      writes: []

  - name: notification-service
    databases:
      reads: []
      writes: []

  - name: search-service
    databases:
      reads: []
      writes: []

databases:
  - name: orders-db
  - name: payments-db
  - name: users-db
